function makeHttpRequest(e,t,a,n,s){let o={};switch(t){case"GET":o={method:"GET",cache:"no-cache"};break;case"POST":let r;if(n instanceof FormData)r=n;else for(let[l,i]of(r=new FormData,Object.entries(n)))r.append(l,i);o={method:"POST",cache:"no-cache",body:r};break;default:throw Error("request_type does not match available methods")}fetch(e,o).then(e=>{switch(a){case"JSON":return e.json();case"HTML":return e.text();default:throw Error("Data response type does not match available response types")}}).then(e=>s(e)).catch(e=>console.trace(e))}function createChart(e,t,a,n,s,o){axis="horizontal"==o?"y":"";let r=new Chart(e,{type:t,responsive:!0,maintainAspectRatio:!1,data:{labels:n,datasets:[{label:a,data:s,backgroundColor:graph_colour_list.sort(()=>.5-Math.random()),borderWidth:1}]},options:{indexAxis:axis}});return r}function make_auto_complete(e,t,a){let n=new autoComplete({selector:e,placeHolder:t,data:{src:a,cache:!0,keys:["tag"]},resultsList:{element(e,t){if(!t.results.length){let a=document.createElement("div");a.setAttribute("class","no_result"),a.innerHTML=`<span>Found No Results for "${t.query}"</span>`,e.prepend(a)}},noResults:!0,maxResults:50},resultItem:{highlight:!0},events:{input:{selection(e){add_to_filters(e.detail.selection.value.id,e.detail.selection.value.tag)}}}});return n}function add_to_filters(e,t){document.getElementsByClassName("filter-list")[0].innerHTML+='<li data-id="'+e+'"><span>'+t+'</span><i class="fa-solid fa-xmark remove-filter"></li>',document.getElementById("hidden-form").innerHTML+='<input type="hidden" name="'+t+'" value="'+e+'">'}function init_tag_form(e){document.addEventListener("click",function(e){e.target&&e.target.classList.contains("remove-filter")&&(document.querySelector('input[value="'+e.target.parentElement.dataset.id+'"]').remove(),e.target.parentElement.remove())});let t=document.getElementById("tag-filter-form");t.addEventListener("submit",function(a){document.getElementById("submit-form").disabled=!0,document.querySelector("article").style.filter="blur(2px)",document.querySelector("section")&&(document.querySelector("section").style.filter="blur(2px)"),a.preventDefault();makeHttpRequest(e,"POST","JSON",new FormData(t),function(a){if(a.success)switch(document.getElementById("submit-form").disabled=!1,document.querySelector("article").style.filter="none",document.querySelector("section")&&(document.querySelector("section").style.filter="none"),e){case"/ajax/filtered_tags":load_tags_table(a.data);break;case"/ajax/filtered_posts":load_posts_keyword_table(a.post_keywords.data),load_posts_top_table(a.top_posts.data),create_post_charts(a);break;case"/ajax/filtered_users":load_user_keyword_table(a.user_keywords.data),load_badges_table(a.filtered_top_badges.data),load_user_year_chart(a.user_years);break;case"/ajax/filtered_locations":load_location_table(a.locations.data)}else t.innerHTML='<h1 class="grid-w-9 grid-sw12 text-red">An error occured, if the problem persists please contact the administration staff<h1>'})})}function export_datatable(e){document.querySelector("button.csv").addEventListener("click",()=>{simpleDatatables.exportCSV(e,{download:!0,lineDelimiter:"\n",columnDelimiter:","})}),document.querySelector("button.sql").addEventListener("click",()=>{simpleDatatables.exportSQL(e,{download:!0,tableName:"export_table"})}),document.querySelector("button.txt").addEventListener("click",()=>{simpleDatatables.exportTXT(e,{download:!0})}),document.querySelector("button.json").addEventListener("click",()=>{simpleDatatables.exportJSON(e,{download:!0,space:3})})}function init_index(){let e,t,a,n,s,o;async function r(e,t){var s,o;document.getElementById("more-"+e).disabled=!0,document.getElementById("less-"+e).disabled=!0,result=await (s=e,o=t,chart="tags"==s?a:n,new Promise((e,t)=>{o<chart.data.labels.length?(chart.data.labels.splice(-5,5),chart.data.datasets.forEach(e=>{e.data.pop()}),chart.update(),e(!0)):makeHttpRequest("/ajax/update_index_bar_chart?count="+o+"&type="+s,"GET","JSON","",function(a){if(a.success){for(let n=chart.data.labels.length;n<a.data.count.length;++n)chart.data.labels.push(a.data.names[n]),chart.data.datasets[0].data[n]=a.data.count[n];chart.update(),e(!0)}else document.getElementById(s+"-wrapper").innerHTML='<h1 class="grid-w-9 grid-sw12 text-red">An error occured, if the problem persists please contact the administration staff<h1>',t(!1)})})),document.getElementById("more-"+e).disabled=!1,t>5?(document.getElementById("less-"+e).disabled=!1,document.getElementById("less-"+e).style.cursor="pointer"):document.getElementById("less-"+e).style.cursor="not-allowed"}makeHttpRequest("/ajax/load_index","GET","JSON","",function(r){e=r.top_tags.data.count.length,t=r.top_badges.data.count.length;let l=[r.question_details.data[0],r.question_details.data[1],r.table_row_count.data.question-r.question_details.data[0]-r.question_details.data[1]],i=document.getElementById("tagChart"),d=document.getElementById("acceptanceChart"),c=document.getElementById("badgeChart"),u=document.getElementById("userChart");a=createChart(i,"bar","Questions with this tag",r.top_tags.data.names,r.top_tags.data.count,""),n=createChart(c,"bar","Most earned badge",r.top_badges.data.names,r.top_badges.data.count,""),s=createChart(d,"doughnut","",["Unanswered","Not Accepted","Accepted"],l,""),o=createChart(u,"line","Age of users by year",r.user_years.data.years,r.user_years.data.count,""),document.querySelector("#tagChart p").innerHTML="Tag names:"+r.top_tags.data.names+"Count:"+r.top_tags.data.count,document.querySelector("#badgeChart p").innerHTML="Badge names:"+r.top_badges.data.names+"Count:"+r.top_badges.data.count,document.querySelector("#acceptanceChart p").innerHTML="Unanswered:"+l[0]+"Answered, not accepted:"+l[1]+"Accepted:"+l[2],document.querySelector("#userChart p").innerHTML="Years:"+r.user_years.data.years+"Users created that year:"+r.user_years.data.count}),document.querySelectorAll(".index-tag").forEach(a=>a.addEventListener("click",a=>{a.target&&"more-tags"==(a.target.id||a.target.parentNode.id)?(count=e+=5,type="tags"):a.target&&"less-tags"==(a.target.id||a.target.parentNode.id)?(count=e-=5,type="tags"):a.target&&"more-badges"==(a.target.id||a.target.parentNode.id)?(count=t+=5,type="badges"):a.target&&"less-badges"==(a.target.id||a.target.parentNode.id)&&(count=t-=5,type="badges"),r(type,count)}))}function init_trending(){let e=1;load_trending_table(e),document.getElementById("load-api-posts").addEventListener("click",function(){load_trending_table(++e)})}function load_trending_table(e){let t;makeHttpRequest(t=1==e?"https://api.stackexchange.com/2.3/questions?order=desc&sort=month&site=stackoverflow":"https://api.stackexchange.com/2.3/questions?page="+e+"&order=desc&sort=month&site=stackoverflow","GET","JSON","",function(t){try{1==e&&(datatable=new simpleDatatables.DataTable("#api-box table",{perPage:15,columns:[{select:[5,6],sortable:!1},{select:[3,4],type:"number"}]}));for(let a=0;a<t.items.length;a++){let n=t.items[a].is_answered?'<i class="text-green fa-solid fa-check"></i>':'<i class="text-red fa-solid fa-xmark"></i>',s=[{Title:t.items[a].title,User:'<a href="'+t.items[a].owner.link+'"target="_blank" rel="noopener noreferrer">'+t.items[a].owner.display_name+"</a>",Tags:t.items[a].tags.join(", "),Score:t.items[a].score,Views:t.items[a].view_count,Answered:n,Link:'<a href="'+t.items[a].link+'" target="_blank" rel="noopener noreferrer"><i class="text-blue fa-solid fa-link"></i></a>'}];datatable.insert(s)}}catch{console.log(t),document.getElementById("api-box").innerHTML='<p class="text-red grid-w-12"><i class="fa-solid fa-triangle-exclamation"></i> Stack Overflow is not available at the moment, please try again later</p>'}})}function init_tags(){makeHttpRequest("/ajax/load_tags","GET","JSON","",function(e){tag_list=make_auto_complete("#tag_search","Search for tags...",e.tag_list.data),load_tags_table(e.top_tags.data),init_tag_form("/ajax/filtered_tags")})}function load_tags_table(e){"undefined"!=typeof datatable&&datatable.destroy(),datatable=new simpleDatatables.DataTable(".tags-main table",{perPage:25,columns:[{select:7,sortable:!1},{select:[1,2,3,4,5,6],type:"number"}]});for(let t=0;t<e.tag_name.length;t++){let a=[{Tag:e.tag_name[t],"Question Count":e.question_count[t],"Answers Count":e.answer_count[t],"Comments Count":e.comment_count[t],"Total Score":e.score[t],"Total Views":e.view_count[t],"Sentiment Score":e.sentiment[t],About:e.link[t]}];datatable.insert(a)}export_datatable(datatable)}function init_posts(){makeHttpRequest("/ajax/load_posts","GET","JSON","",function(e){tag_list=make_auto_complete("#tag_search","Search for tags...",e.tag_list.data),load_posts_keyword_table(e.post_keywords.data),load_posts_top_table(e.top_posts.data),create_post_charts(e),init_tag_form("/ajax/filtered_posts")})}function create_post_charts(e){"undefined"!=typeof accept_doughnut_chart&&accept_doughnut_chart.destroy(),"undefined"!=typeof engagement_chart&&engagement_chart.destroy();let t=[e.question_details.data[0],e.question_details.data[1],e.table_row_count.data.question-e.question_details.data[0]-e.question_details.data[1]],a=[e.table_row_count.data.question/e.question_details.data[0],e.table_row_count.data.question/e.question_details.data[1]],n=document.getElementById("acceptanceChart"),s=document.getElementById("engagementChart");accept_doughnut_chart=createChart(n,"doughnut","",["Unanswered","Not Accepted","Accepted"],t,""),engagement_chart=createChart(s,"bar","Engagement level",["Average Answers","Average Comments"],a,""),document.querySelector("#acceptanceChart p").innerHTML="Unanswered:"+t[0]+"Answered, not accepted:"+t[1]+"Accepted:"+t[2],document.querySelector("#engagementChart p").innerHTML="Average Answers:"+a[0]+"Average Comments:"+a[1]}function load_posts_keyword_table(e){"undefined"!=typeof key_word_datatable&&key_word_datatable.destroy(),key_word_datatable=new simpleDatatables.DataTable(".posts-main article table",{perPageSelect:!1,perPage:25,columns:[{select:[1,2,3,4,5,6],type:"number"}]});for(let t=0;t<e.keyword.length;t++){let a=[{Keyword:e.keyword[t],"Question Count":e.question_count[t],"Answers Count":e.answer_count[t],"Comments Count":e.comments_count[t],"Total Views":e.view_count[t],"Total Score":e.total_score[t],"Sentiment Score":e.sentiment[t]}];key_word_datatable.insert(a)}export_datatable(key_word_datatable)}function load_posts_top_table(e){"undefined"!=typeof posts_datatable&&posts_datatable.destroy(),posts_datatable=new simpleDatatables.DataTable(".posts-main section table",{perPage:5,perPageSelect:!1,columns:[{select:[1],type:"number"},{select:[2],sortable:!1}]});for(let t=0;t<e.title.length;t++){let a=[{Title:e.title[t],Score:e.score[t],Link:'<a href="'+e.link[t]+'" target="_blank" rel="noopener noreferrer"><i class="text-blue fa-solid fa-link"></i></a>'}];posts_datatable.insert(a)}}function init_users(){makeHttpRequest("/ajax/load_users","GET","JSON","",function(e){tag_list=make_auto_complete("#tag_search","Search for tags...",e.tag_list.data),load_user_keyword_table(e.user_keywords.data),load_badges_table(e.top_badges.data),load_user_year_chart(e.user_years),init_tag_form("/ajax/filtered_users")})}function load_user_keyword_table(e){"undefined"!=typeof key_word_datatable&&key_word_datatable.destroy(),key_word_datatable=new simpleDatatables.DataTable("#keyword-table",{perPage:25,columns:[{select:[1,2,3],type:"number"}]});for(let t=0;t<e.keyword.length;t++){let a=[{Keyword:e.keyword[t],"Occurance Count":e.occ_count[t],"Average Reputation":e.avg_rep[t],"Total Reputation":e.total_rep[t],"Average Creation Date":e.avg_acc_age[t]}];key_word_datatable.insert(a)}export_datatable(key_word_datatable)}function load_badges_table(e){"undefined"!=typeof badges_datatable&&badges_datatable.destroy(),badges_datatable=new simpleDatatables.DataTable("#badges-table",{perPage:5,columns:[{select:[1],type:"number"}]});for(let t=0;t<e.names.length;t++){let a=[{Badge:e.names[t],Count:e.count[t]}];badges_datatable.insert(a)}}function load_user_year_chart(e){"undefined"!=typeof user_line_chart&&user_line_chart.destroy();user_line_chart=createChart(document.getElementById("userChart"),"line","Age of users by year",e.data.years,e.data.count,""),document.querySelector("#userChart p").innerHTML="Years:"+e.data.years+"Users created that year:"+e.data.count}function init_locations(){makeHttpRequest("/ajax/load_locations","GET","JSON","",function(e){tag_list=make_auto_complete("#tag_search","Search for tags...",e.tag_list.data),load_location_table(e.locations.data),init_tag_form("/ajax/filtered_locations")})}function load_location_table(e){"undefined"!=typeof location_datatable&&location_datatable.destroy(),location_datatable=new simpleDatatables.DataTable("#location-table",{perPage:25,columns:[{select:[1,2,4,5,6,7],type:"number"}]});for(let t=0;t<e.location.length;t++){let a=[{Location:e.location[t],Count:e.count[t],"Average Reputation":e.avg_rep[t],"Total Reputation":e.total_rep[t],"Average Creation Date":e.avg_acc_age[t],"Questions Asked":e.question_count[t],"Answered Given":e.answer_count[t],"Comments Made":e.comment_count[t]}];location_datatable.insert(a)}}function reset_nav_menu(){document.getElementById("side-nav-container").style.width=0,document.querySelector("body").style.marginLeft=0,document.querySelector("aside nav").style.opacity=0,document.getElementById("nav-btn-open").style.opacity=100,document.getElementsByClassName("active")[0].style.opacity=0}graph_colour_list=["#5F295F","#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA"],document.addEventListener("DOMContentLoaded",()=>{document.getElementById("nav-btn-open").addEventListener("click",()=>{document.getElementById("side-nav-container").style.width="6rem",document.querySelector("body").style.marginLeft="6rem",document.querySelector("aside nav").style.opacity=100,document.getElementById("nav-btn-open").style.opacity=0,document.getElementsByClassName("active")[0].style.opacity=100}),document.getElementById("nav-btn-close").addEventListener("click",()=>{reset_nav_menu()}),window.addEventListener("resize",()=>{this.window.innerWidth<600?(document.getElementById("nav-btn-close").style.display="none",document.getElementById("nav-btn-open").style.display="none",document.getElementById("side-nav-container").style.width="100%",document.getElementById("side-nav-container").style.height="4rem",document.querySelector("body").style.marginLeft=0,document.querySelector("aside nav").style.opacity=100,document.getElementsByClassName("active")[0].style.opacity=100):(document.getElementById("nav-btn-close").style.display="block",document.getElementById("nav-btn-open").style.display="block",document.getElementById("side-nav-container").style.height="100%",reset_nav_menu())}),document.getElementById("info-modal-open").addEventListener("click",()=>{document.querySelector("main").style.filter="blur(2px)",document.getElementById("info-modal").showModal()}),document.getElementById("info-modal-close").addEventListener("click",()=>{document.querySelector("main").style.filter="none",document.getElementById("info-modal").close()})});