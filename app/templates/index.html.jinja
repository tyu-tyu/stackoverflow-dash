{% extends "layout.html.jinja" %}
{% set active_page = "index" %}
{% block title %}Home{% endblock %}
{% block header %}Stack Overflow Data Dashboards{% endblock %}
{% block main_name %}index{% endblock %}
{% block content %}
	<section id="stats-box" class="grid-panel grid-w-12">
		<div class="grid-w-3 grid-sw-12 bg-light text-dark">
			<p class="text-center">Data taken between <i class="fa-solid fa-calendar"></i></p>
			<p><span class="stats-figure"><span class="text-purple-light">{{ data['question_date_range']['data'][0] }} {{ data['question_date_range']['data'][1] }}</span></p>
		</div>
		<div class="grid-w-6 grid-sw-12 bg-light text-dark">
			<p><span class="text-purple-light">{{ data['table_row_count']['data']['question'] }}</span> Questions</p>
			<p><span class="text-purple-light">{{ data['table_row_count']['data']['answer'] }}</span> Answers</p>
			<p><span class="text-purple-light">{{ data['table_row_count']['data']['comments'] }}</span> Comments</p>
			<p><span class="text-purple-light">{{ data['table_row_count']['data']['tag_link']}}</span> Tags</p>
		</div>
		<div class="grid-w-3 grid-sw-12 bg-light text-dark">
			<p><span class="text-purple-light">{{ data['table_row_count']['data']['user'] }}</span> Users</p>
			<p><span class="text-purple-light">{{ data['table_row_count']['data']['badge_link'] }}</span> Badges</p>
		</div>
	</section>
	<section id="post-box" class="grid-panel bg-light grid-w-6 grid-sw-12">
		<div class="grid-w-3 grid-sw-12">
			<h1 class="text-center">Welcome</h1>
			<p>
				Welcome to our university website, where we provide insights and metrics based on data from Stack Overflow. 
				Our platform offers a unique opportunity to explore trends in programming languages, technologies, and practices through analysis of the Stack Overflow community. 
				Here you can gain valuable insights to inform your teaching, research, and industry partnerships.
				Join us in exploring the latest developments in the world of technology and programming.
			</p>
		</div>
		<div class="grid-w-3 grid-sw-12">
			<h1 class="grid-w-3 grid-sw-12 text-center" id="answer-header">Question responses</h1>
			<div class="grid-w-3 grid-sw-12 canvas-wrapper" id="question-wrapper">
				<canvas id="acceptanceChart" aria-label="Question responses" role="img">
					<p>
						Unanswered:{{ data['question_details']['data'][0] }},
						Not accepted:{{ data['question_details']['data'][1] }},
						Accepted answers:{{ data['table_row_count']['data']['question'] }} - {{ data['question_details']['data'][0] }} - {{ data['question_details']['data'][1] }}
					</p>
				</canvas>
			</div>
		</div>
		<h1 class="grid-w-4 grid-sw-8 text-left">Question tags</h1>
		<div class="grid-w-2 grid-sw-4 button-wrapper">
			<button class="btn-green index-tag" id="more-tags"><i class="fa-solid fa-plus"></i></button>
			<button class="btn-red index-tag" id="less-tags"><i class="fa-solid fa-minus"></i></button>
		</div>
		<div class="grid-w-6 grid-sw-12 canvas-wrapper" id="tags-wrapper">
			<canvas id="tagChart" aria-label="Tags chart" role="img">
				<p>
					Most popular tags:{{ data['top_tags']['data']['names']}},
					Counts of those tags:{{ data['top_tags']['data']['count']}}
				</p>
			</canvas>
		</div>
		<i class="grid-w-12 text-grey">For more details on a tag and more questions: <a href="https://stackoverflow.com/tags" target="_blank" rel="noopener noreferrer">Click here</a></i>
	</section>
	<section id="user-box" class="grid-panel grid-w-6 grid-sw-12 bg-light">
		<h1 class="grid-w-12 text-left">Users by year created</h1>
		<p class="grid-w-12 text-center" id="year_list">
			{% for item in data['user_years']['data'] %}
				<span class="grid-sw-6 text-purple-light">{{ item.0 }}</span>
				<span class="grid-sw-6">{{ item.1 }}</span>
			{% endfor %}
		</p>
		<h1 class="grid-w-4 grid-sw-8 text-left">User badges</h1>
		<div class="grid-w-2 grid-sw-4 button-wrapper">
			<button class="btn-green index-tag" id="more-badges"><i class="fa-solid fa-plus"></i></button>
			<button class="btn-red index-tag" id="less-badges"><i class="fa-solid fa-minus"></i></button>
		</div>
		<div class="grid-w-6 grid-sw-12 canvas-wrapper" id="badge-wrapper">
			<canvas id="badgeChart" aria-label="Badge chart" role="img">
				<p>
					Most popular badges:{{ data['top_badges']['data']['names'] | tojson }},
					Counts of those badges:{{ data['top_badges']['data']['count'] | tojson }}
				</p>
			</canvas>
		</div>
		<i class="grid-w-12 text-grey">For more details on user badges: <a href="https://stackoverflow.com/badges" target="_blank" rel="noopener noreferrer">Click here</a></i>
	</section>
{% endblock %}
{% block scripts %}
	<script>
		let tag_count = {{ data['top_tags']['data']['count'] | length }};
		let badge_count = {{ data['top_badges']['data']['count'] | length }};
		let acceptance = [
			{{ data['question_details']['data'][0] }},
			{{ data['question_details']['data'][1] }},
			{{ data['table_row_count']['data']['question'] }} - {{ data['question_details']['data'][0] }} - {{ data['question_details']['data'][1] }}
		];
		const tag_ctx = document.getElementById('tagChart');
		const accept_ctx = document.getElementById('acceptanceChart');
		const badge_ctx = document.getElementById('badgeChart');
		const index_tag_chart = createChart(tag_ctx,'bar','Questions with this tag',{{ data['top_tags']['data']['names'] | tojson }},{{ data['top_tags']['data']['count'] | tojson }},'');
		const index_badge_chart = createChart(badge_ctx, 'bar', 'Most earned badge',{{ data['top_badges']['data']['names'] | tojson }},{{ data['top_badges']['data']['count'] | tojson }},'');
		const accept_doughnut_chart = createChart(accept_ctx, 'doughnut','',['Unanswered','Not Accepted', 'Accepted'],acceptance,'');
	</script>
{% endblock %}
